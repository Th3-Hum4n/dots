#!/bin/sh

. ${HOME}/var/cache/tm/colors.sh

h=`res -h`

grp() {
    read -r main < /tmp/info/wm/groups/main
    read -r num  < /tmp/info/wm/groups/num
    curs=`cat /tmp/info/wm/groups/cur`
    i=1
    while [ ${i} -le ${num} ]; do
        [ ${i} -eq ${main} ] && echo -n 'x ' ||
                case ${curs} in
                    (*${i}*) echo -n '+ ' ;;
                    (*)      echo -n '- ' ;;
                esac
        : $((i += 1))
    done
    unset i main curs
    echo ''
}

while :; do
    echo %{l}'  ' `grp` %{r}`date +'%H:%M'`'  '
    sleep 0.1
done | \
    lemonbar -d -b -f 'scientifica:pixelsize=12'  -B ${color0} -F ${color7} \
             -g "140x18+20+$((h - 40))" -r 2 -R ${color1}
