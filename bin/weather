#!/bin/sh
# a weather notification sender
# only sends the current weather condition, ie sunny or cloudly and temperature in K

# get data if not present already
[ ! -f /tmp/bar/raw_weather ] &&\
    curl -s https://wttr.in/chennai?m0TQP > ${HOME}/tmp/raw_weather

# get the weather conditon
weather_cond=`cat ${HOME}/tmp/raw_weather | head -n 1 | grep -oE "[ A-z]+"`
weather_condition=""

for word in ${weather_cond}; do
    weather_conditon="${weather_conditon}${word} "
done

# get the current temperature
temperature=`cat ${HOME}/tmp/raw_weather | head -n 1 | grep -oE "[0-9]+" | head -n 1 | tr -d '\n'`
temperature=$((temperature + 273))

# send the notification
notify-send "weather" "${weather_cond}"
sleep 2
notify-send "temperature" "${temperature}K"
